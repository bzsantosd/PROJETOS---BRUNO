<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AccessPass - Login</title>
    <link rel="stylesheet" href="/techfit_php/public/css/catraca.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Adiciona a fonte, já que não temos o arquivo no exemplo */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
    </style>
</head>
<body>
    <div class="login-container">
        <div class="logo-area">
            <div class="logo-icon">
                <i class="fas fa-dumbbell"></i>
            </div>
            <h1>Tech Fit</h1>
            <p>Escanei o QrCode para acessar.</p>
        </div>
        <button class="btn-admin-mode" id="open-catraca-modal">
            <i class="fas fa-th-large"></i> Modo Catraca
        </button>
    </div>

    <div class="modal-overlay" id="catraca-modal-overlay">
        <div class="modal-content">
            <div class="modal-close" id="close-catraca-modal">&times;</div>
            
            <div class="catraca-simulation">
                <p>Escaneando QR Code...</p>
                <div class="progress-bar-placeholder"></div>
            </div>

            <div class="catraca-actions">
                <button class="btn-action-approve">
                    <i class="fas fa-check"></i> Confirmar
                </button>
                <button class="btn-action-reject">
                    <i class="fas fa-times"></i> Cancelar
                </button>
            </div>
        </div>
    </div>

    <script <script>
    const openModalBtn = document.getElementById('open-catraca-modal');
    const closeModalBtn = document.getElementById('close-catraca-modal');
    const modalOverlay = document.getElementById('catraca-modal-overlay');
    const catracaText = modalOverlay.querySelector('.catraca-simulation p');
    const progressBar = modalOverlay.querySelector('.progress-bar-placeholder');
    const approveBtn = modalOverlay.querySelector('.btn-action-approve');
    const rejectBtn = modalOverlay.querySelector('.btn-action-reject');

    let qrSimulationInterval;

    // --- Funções do Modal ---
    function openCatracaModal() {
        // Reinicia o estado
        catracaText.textContent = "Escaneando QR Code...";
        progressBar.style.width = '80%'; // Barra cheia de novo
        progressBar.style.backgroundColor = '#007bff'; // Azul padrão

        modalOverlay.style.display = 'flex';
        
        // Inicia a simulação do QR Code
        startQrSimulation();
    }

    function closeCatracaModal() {
        // Para qualquer simulação em andamento
        clearInterval(qrSimulationInterval);
        modalOverlay.style.display = 'none';
    }

    // --- Simulação do QR Code ---
    function startQrSimulation() {
        // Simula 3 segundos de leitura de QR Code
        let progress = 0;
        const totalDuration = 3000; // 3 segundos em milissegundos
        const intervalTime = 50; // Atualiza a cada 50ms
        const steps = totalDuration / intervalTime;
        const progressIncrement = 100 / steps;
        
        progressBar.style.width = '0%';
        progressBar.style.transition = `width ${totalDuration / 1000}s linear`;
        
        // Simula a animação da barra (do 0% para 100% em 3s)
        setTimeout(() => {
             progressBar.style.width = '100%';
        }, 50);

        // Após 3 segundos, muda o estado para aguardar a confirmação manual
        setTimeout(() => {
            progressBar.style.transition = 'none';
            progressBar.style.width = '100%';
            progressBar.style.backgroundColor = '#1abc9c'; // Verde, indicando sucesso na leitura
            catracaText.textContent = "Esperando Confirmação...";
        }, totalDuration);
    }


    // --- Event Listeners ---
    
    // Abrir modal
    openModalBtn.addEventListener('click', openCatracaModal);

    // Fechar modal no 'X'
    closeModalBtn.addEventListener('click', closeCatracaModal);

    // Fechar modal ao clicar fora
    modalOverlay.addEventListener('click', function(e) {
        if (e.target === modalOverlay) {
            closeCatracaModal();
        }
    });

    // Ações de Confirmação (Simulação)
    approveBtn.addEventListener('click', () => {
        alert('Acesso APROVADO! Simulação concluída.');
        closeCatracaModal();
    });

    rejectBtn.addEventListener('click', () => {
        alert('Acesso RECUSADO! Simulação concluída.');
        closeCatracaModal();
    });

</script>
</body>
</html>